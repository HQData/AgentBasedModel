
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>chad &#8212; ABMHAP 2018.06 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for chad</h1><div class="highlight"><pre>
<span></span><span class="c1"># The United States Environmental Protection Agency through its Office of</span>
<span class="c1"># Research and Development has developed this software. The code is made</span>
<span class="c1"># publicly available to better communicate the research. All input data</span>
<span class="c1"># used fora given application should be reviewed by the researcher so</span>
<span class="c1"># that the model results are based on appropriate data for any given</span>
<span class="c1"># application. This model is under continued development. The model and</span>
<span class="c1"># data included herein do not represent and should not be construed to</span>
<span class="c1"># represent any Agency determination or policy.</span>
<span class="c1">#</span>
<span class="c1"># This file was written by Dr. Namdi Brandon</span>
<span class="c1"># ORCID: 0000-0001-7050-1538</span>
<span class="c1"># August 14, 2017</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file contains data from the Consolidated Human Activity Database (CHAD). This module contains constants \</span>
<span class="sd">necessary to access various files in the CHAD.</span>

<span class="sd">This module contains the following classes:</span>

<span class="sd">#. :class:`chad.CHAD`</span>
<span class="sd">#. :class:`chad.CHAD_RAW`.</span>

<span class="sd">.. moduleauthor:: Dr. Namdi Brandon</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># ===============================================</span>
<span class="c1"># import</span>
<span class="c1"># ===============================================</span>

<span class="c1"># general math capability</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># dataframe capability</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># add date/time and zipfile capabilities</span>
<span class="kn">import</span> <span class="nn">datetime</span><span class="o">,</span> <span class="nn">zipfile</span>

<span class="c1"># ABMHAP modules</span>
<span class="kn">import</span> <span class="nn">my_globals</span> <span class="k">as</span> <span class="nn">mg</span>
<span class="kn">import</span> <span class="nn">social</span><span class="o">,</span> <span class="nn">temporal</span>

<span class="c1"># ===============================================</span>
<span class="c1"># constants</span>
<span class="c1"># ===============================================</span>

<span class="c1"># The directory the compressed CHAD data is in</span>
<span class="n">FDIR_DATA</span>       <span class="o">=</span> <span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data&#39;</span>

<span class="c1"># this is where the uncompressed data lies</span>
<span class="n">FDIR_DATA_LARGE</span> <span class="o">=</span> <span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data_large&#39;</span>

<span class="c1">#</span>
<span class="c1"># for the uncompressed files</span>
<span class="c1">#</span>

<span class="c1"># the file directories</span>
<span class="n">FDIR_DEMOGRAPHY_LARGE</span>       <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">demography&#39;</span>

<span class="n">FDIR_ALL_LARGE</span>              <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">all&#39;</span>
<span class="n">FDIR_ADULT_LARGE</span>            <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult&#39;</span>
<span class="n">FDIR_ADULT_WORK_LARGE</span>       <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult_work&#39;</span>
<span class="n">FDIR_ADULT_NON_WORK_LARGE</span>   <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult_non_work&#39;</span>
<span class="n">FDIR_CHILD_SCHOOL_LARGE</span>     <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">child_school&#39;</span>
<span class="n">FDIR_CHILD_YOUNG_LARGE</span>      <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">child_young&#39;</span>

<span class="c1">#</span>
<span class="c1"># for the compressed files</span>
<span class="c1">#</span>
<span class="n">FDIR_DEMOGRAPHY</span>             <span class="o">=</span> <span class="n">FDIR_DATA</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">demography&#39;</span>

<span class="n">FNAME_ALL</span>                   <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">all.zip&#39;</span>
<span class="n">FNAME_ADULT</span>                 <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult.zip&#39;</span>
<span class="n">FNAME_ADULT_NON_WORK</span>        <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult_non_work.zip&#39;</span>
<span class="n">FNAME_ADULT_WORK</span>            <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">adult_work.zip&#39;</span>
<span class="n">FNAME_CHILD_SCHOOL</span>          <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">child_school.zip&#39;</span>
<span class="n">FNAME_CHILD_YOUNG</span>           <span class="o">=</span> <span class="n">FDIR_DEMOGRAPHY</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">child_young.zip&#39;</span>

<span class="c1"># file name for the CHAD data (questionnaire and events data)</span>
<span class="n">FNAME_CHAD</span>                  <span class="o">=</span> <span class="n">FDIR_DATA</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">chad.zip&#39;</span>

<span class="c1"># file name for the CHAD activity data in zip files</span>
<span class="n">FNAME_COMMUTE_FROM_WORK</span>     <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">commute_from_work.zip&#39;</span>
<span class="n">FNAME_COMMUTE_TO_WORK</span>       <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">commute_to_work.zip&#39;</span>

<span class="n">FNAME_EAT_BREAKFAST</span>         <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">eat_breakfast.zip&#39;</span>
<span class="n">FNAME_EAT_DINNER</span>            <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">eat_dinner.zip&#39;</span>
<span class="n">FNAME_EAT_LUNCH</span>             <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">eat_lunch.zip&#39;</span>

<span class="n">FNAME_EDUCATION</span>             <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">education.zip&#39;</span>
<span class="n">FNAME_SLEEP</span>                 <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">sleep.zip&#39;</span>
<span class="n">FNAME_WORK</span>                  <span class="o">=</span> <span class="n">FDIR_DATA_LARGE</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">work.zip&#39;</span>

<span class="n">FNAME_OMNI</span>          <span class="o">=</span> <span class="p">{</span> <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_FROM_WORK</span><span class="p">:</span> <span class="n">FNAME_COMMUTE_FROM_WORK</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_TO_WORK</span><span class="p">:</span> <span class="n">FNAME_COMMUTE_TO_WORK</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_BREAKFAST</span><span class="p">:</span> <span class="n">FNAME_EAT_BREAKFAST</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_DINNER</span><span class="p">:</span> <span class="n">FNAME_EAT_DINNER</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_LUNCH</span><span class="p">:</span> <span class="n">FNAME_EAT_LUNCH</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_SLEEP</span><span class="p">:</span> <span class="n">FNAME_SLEEP</span><span class="p">,</span>
                        <span class="n">mg</span><span class="o">.</span><span class="n">KEY_WORK</span><span class="p">:</span> <span class="n">FNAME_WORK</span><span class="p">,</span>
                        <span class="p">}</span>

<span class="c1"># the CHAD raw data files within FNAME_CHAD</span>
<span class="n">FNAME_EVENTS</span>    <span class="o">=</span> <span class="s1">&#39;events_071413_mod.csv&#39;</span>
<span class="n">FNAME_QUEST</span>     <span class="o">=</span> <span class="s1">&#39;quest_032913_mod.csv&#39;</span>

<span class="c1">#</span>
<span class="c1"># file names for statistics.</span>
<span class="c1"># they are the the moments (means and standard deviations) of the duration and start time data</span>
<span class="c1"># for each person who has longitudinal data</span>
<span class="c1">#</span>

<span class="c1"># the file names for the CHAD activity-moments data</span>
<span class="n">START</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">END</span>     <span class="o">=</span> <span class="mi">2</span>
<span class="n">DT</span>      <span class="o">=</span> <span class="mi">3</span>
<span class="n">RECORD</span>  <span class="o">=</span> <span class="mi">4</span>

<span class="n">FNAME_STATS_DEFAULT</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;stats_dt.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_start.csv&#39;</span><span class="p">)</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for commuting to work</span>
<span class="n">FNAME_STATS_COMMUTE_TO_WORK</span>     <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_to_work/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_to_work/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_to_work/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_to_work/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for commuting from work</span>
<span class="n">FNAME_STATS_COMMUTE_FROM_WORK</span>   <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_from_work/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_from_work/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_from_work/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/commute_from_work/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for eating breakfast</span>
<span class="n">FNAME_STATS_EAT_BREAKFAST</span>       <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_breakfast/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_breakfast/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_breakfast/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_breakfast/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for eating dinner</span>
<span class="n">FNAME_STATS_EAT_DINNER</span>          <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_dinner/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_dinner/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_dinner/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_dinner/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for eating lunch</span>
<span class="n">FNAME_STATS_EAT_LUNCH</span>           <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_lunch/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_lunch/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_lunch/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/eat_lunch/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for sleeping</span>
<span class="n">FNAME_STATS_SLEEP</span>               <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/sleep/all/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/sleep/all/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/sleep/all/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/sleep/all/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for working</span>
<span class="n">FNAME_STATS_WORK</span>                <span class="o">=</span> <span class="p">{</span><span class="n">START</span><span class="p">:</span> <span class="s1">&#39;longitude/work/stats_start.csv&#39;</span><span class="p">,</span>
                                   <span class="n">END</span><span class="p">:</span> <span class="s1">&#39;longitude/work/stats_end.csv&#39;</span><span class="p">,</span>
                                   <span class="n">DT</span><span class="p">:</span> <span class="s1">&#39;longitude/work/stats_dt.csv&#39;</span><span class="p">,</span>
                                   <span class="n">RECORD</span><span class="p">:</span> <span class="s1">&#39;longitude/work/record.csv&#39;</span><span class="p">,}</span>

<span class="c1"># file name for statistics from CHAD about longitudinal patterns for all of the activities</span>
<span class="n">FNAME_STATS_OMNI</span> <span class="o">=</span> <span class="p">{</span> <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_FROM_WORK</span><span class="p">:</span> <span class="n">FNAME_STATS_COMMUTE_FROM_WORK</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_TO_WORK</span><span class="p">:</span> <span class="n">FNAME_STATS_COMMUTE_TO_WORK</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_BREAKFAST</span><span class="p">:</span> <span class="n">FNAME_STATS_EAT_BREAKFAST</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_DINNER</span><span class="p">:</span> <span class="n">FNAME_STATS_EAT_DINNER</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_LUNCH</span><span class="p">:</span> <span class="n">FNAME_STATS_EAT_LUNCH</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_SLEEP</span><span class="p">:</span> <span class="n">FNAME_STATS_SLEEP</span><span class="p">,</span>
                     <span class="n">mg</span><span class="o">.</span><span class="n">KEY_WORK</span><span class="p">:</span> <span class="n">FNAME_STATS_WORK</span><span class="p">,</span>
                     <span class="p">}</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for commuting from work</span>
<span class="n">FNAME_RECORD_COMMUTE_FROM_WORK</span>  <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/commute_from_work/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for commuting to work</span>
<span class="n">FNAME_RECORD_COMMUTE_TO_WORK</span>    <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/commute_to_work/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for eating breakfast</span>
<span class="n">FNAME_RECORD_EAT_BREAKFAST</span>      <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/eat_breakfast/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for eating dinner</span>
<span class="n">FNAME_RECORD_EAT_DINNER</span>         <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/eat_dinner/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for eating lunch</span>
<span class="n">FNAME_RECORD_EAT_LUNCH</span>          <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/eat_lunch/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for sleeping</span>
<span class="n">FNAME_RECORD_SLEEP</span>              <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/sleep/all/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for working</span>
<span class="n">FNAME_RECORD_WORK</span>               <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;longitude/work/record.csv&#39;</span><span class="p">,)</span>

<span class="c1"># filenames for CHAD records of  for longitudinal data for all of the activities</span>
<span class="n">FNAME_RECORD_OMNI</span> <span class="o">=</span> <span class="p">{</span> <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_FROM_WORK</span><span class="p">:</span> <span class="n">FNAME_RECORD_COMMUTE_FROM_WORK</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_COMMUTE_TO_WORK</span><span class="p">:</span> <span class="n">FNAME_RECORD_COMMUTE_TO_WORK</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_BREAKFAST</span><span class="p">:</span> <span class="n">FNAME_RECORD_EAT_BREAKFAST</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_DINNER</span><span class="p">:</span> <span class="n">FNAME_RECORD_EAT_DINNER</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_EAT_LUNCH</span><span class="p">:</span> <span class="n">FNAME_RECORD_EAT_LUNCH</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_SLEEP</span><span class="p">:</span> <span class="n">FNAME_RECORD_SLEEP</span><span class="p">,</span>
                      <span class="n">mg</span><span class="o">.</span><span class="n">KEY_WORK</span><span class="p">:</span> <span class="n">FNAME_RECORD_WORK</span><span class="p">,}</span>

<span class="c1"># the columns from the raw CHAD events data to keep</span>
<span class="n">EVENTS_RAW_COLNAMES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHADID&#39;</span><span class="p">,</span> <span class="s1">&#39;PID&#39;</span><span class="p">,</span> <span class="s1">&#39;starttime&#39;</span><span class="p">,</span> <span class="s1">&#39;endtime&#39;</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">,</span> <span class="s1">&#39;act&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">]</span>

<span class="c1"># the columns from the CHAD events data to keep</span>
<span class="n">EVENTS_COLNAMES</span>     <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHADID&#39;</span><span class="p">,</span> <span class="s1">&#39;PID&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;act&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">]</span>

<span class="c1"># the columns from the raw CHAD questionnaire data to keep</span>
<span class="n">QUEST_COLNAMES</span>      <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHADID&#39;</span><span class="p">,</span> <span class="s1">&#39;PID&#39;</span><span class="p">,</span> <span class="s1">&#39;rawid&#39;</span><span class="p">,</span> <span class="s1">&#39;daynum&#39;</span><span class="p">,</span> <span class="s1">&#39;totaldays&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;daymonth&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;dayofweek&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;wdwe&#39;</span><span class="p">,</span> <span class="s1">&#39;weekend&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;employed&#39;</span><span class="p">]</span>

<span class="c1"># activity codes for &#39;X and &#39;U&#39; found in the raw CHAD data</span>
<span class="n">ACT_X</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ACT_U</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="c1"># ===============================================</span>
<span class="c1"># constants based on the CHAD data</span>
<span class="c1"># ===============================================</span>

<span class="c1"># the minimum and maximum duration of sleep considered [hours]</span>
<span class="n">SLEEP_DT_MIN</span><span class="p">,</span> <span class="n">SLEEP_DT_MAX</span>          <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span>

<span class="c1"># the minimum and maximum start time of sleep considered [hours]</span>
<span class="n">SLEEP_START_MIN</span><span class="p">,</span> <span class="n">SLEEP_START_MAX</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span> <span class="c1">#(periodic time, regular time)</span>

<span class="c1"># the minimum and maximum end time of sleep considered [hours]</span>
<span class="n">SLEEP_END_MIN</span><span class="p">,</span> <span class="n">SLEEP_END_MAX</span>        <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span>

<span class="c1"># work start time min [hours]</span>
<span class="n">WORK_START_MIN</span>      <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># the minimum and maximum duration for the mean duration for a meal</span>
<span class="n">MEAL_DT_MIN</span><span class="p">,</span> <span class="n">MEAL_DT_MAX</span> <span class="o">=</span> <span class="mf">5.</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.5</span>

<span class="c1"># the minimum and maximum duration for the mean duration of breakfast</span>
<span class="n">BREAKFAST_DT_MIN</span><span class="p">,</span> <span class="n">BREAKFAST_DT_MAX</span>  <span class="o">=</span> <span class="n">MEAL_DT_MIN</span><span class="p">,</span> <span class="n">MEAL_DT_MAX</span>

<span class="c1"># the minimum and maximum duration for the mean duration of lunch</span>
<span class="n">LUNCH_DT_MIN</span><span class="p">,</span> <span class="n">LUNCH_DT_MAX</span>          <span class="o">=</span> <span class="n">MEAL_DT_MIN</span><span class="p">,</span> <span class="n">MEAL_DT_MAX</span>

<span class="c1"># the minimum and maximum duration for the mean duration of dinner</span>
<span class="n">DINNER_DT_MIN</span><span class="p">,</span> <span class="n">DINNER_DT_MAX</span>        <span class="o">=</span> <span class="n">MEAL_DT_MIN</span><span class="p">,</span> <span class="n">MEAL_DT_MAX</span>

<span class="c1"># lunch start time minimum [hours]</span>
<span class="n">LUNCH_START_MIN</span>     <span class="o">=</span> <span class="mi">11</span>

<span class="c1"># dinner start time minimum [hours]</span>
<span class="n">DINNER_START_MIN</span>    <span class="o">=</span> <span class="mf">15.5</span>

<span class="c1"># breakfast start min</span>
<span class="n">BREAKFAST_START_MIN</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># breakfast end time maximum</span>
<span class="n">BREAKFAST_END_MAX</span>   <span class="o">=</span> <span class="n">LUNCH_START_MIN</span>  <span class="o">-</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">60</span>

<span class="c1"># lunch end time maximum</span>
<span class="n">LUNCH_END_MAX</span>       <span class="o">=</span> <span class="n">DINNER_START_MIN</span> <span class="o">-</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">60</span>

<span class="c1"># dinner end time maximum</span>
<span class="n">DINNER_END_MAX</span>      <span class="o">=</span> <span class="mi">22</span>

<span class="c1"># the commute to school start time minimum and maximum</span>
<span class="n">COMMUTE_TO_SCHOOL_START_MIN</span>     <span class="o">=</span> <span class="mi">5</span>
<span class="n">COMMUTE_TO_SCHOOL_START_MAX</span>     <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># the commute to school end time maximum</span>
<span class="n">COMMUTE_TO_SCHOOL_END_MAX</span>       <span class="o">=</span> <span class="mi">11</span>

<span class="c1"># the commute from school start time minimum and maximum</span>
<span class="n">COMMUTE_FROM_SCHOOL_START_MIN</span>   <span class="o">=</span> <span class="mi">13</span>
<span class="n">COMMUTE_FROM_SCHOOL_START_MAX</span>   <span class="o">=</span> <span class="mi">17</span>

<span class="c1"># the commute from school end time maximum</span>
<span class="n">COMMUTE_FROM_SCHOOL_END_MAX</span>     <span class="o">=</span> <span class="mi">18</span>

<span class="c1"># commute to work start time minimum and maximum</span>
<span class="n">COMMUTE_TO_WORK_START_MIN</span>       <span class="o">=</span> <span class="mi">3</span>
<span class="n">COMMUTE_TO_WORK_START_MAX</span>       <span class="o">=</span> <span class="mi">12</span>

<span class="c1"># commute to work end time maximum</span>
<span class="n">COMMUTE_TO_WORK_END_MAX</span>         <span class="o">=</span> <span class="mi">13</span>

<span class="c1"># commute from work start time minimum and maximum</span>
<span class="n">COMMUTE_FROM_WORK_START_MIN</span>     <span class="o">=</span> <span class="mi">14</span>
<span class="n">COMMUTE_FROM_WORK_START_MAX</span>     <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># commute form work end time maximum</span>
<span class="n">COMMUTE_FROM_WORK_END_MAX</span>       <span class="o">=</span> <span class="mi">22</span>

<span class="c1"># ===============================================</span>
<span class="c1"># class CHAD</span>
<span class="c1"># ===============================================</span>

<div class="viewcode-block" id="CHAD"><a class="viewcode-back" href="../chad.html#chad.CHAD">[docs]</a><span class="k">class</span> <span class="nc">CHAD</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This object is in charge of accessing the compressed data files from CHAD.</span>

<span class="sd">    :param str fname: the directory to the respective compressed data files</span>
<span class="sd">    :param str mode: the mode (read, write, or both) the zipfile will work under</span>

<span class="sd">    :ivar str fname_zip: the directory to the respective compressed data file (.zip)</span>
<span class="sd">    :ivar int mode: the mode (read, write, or both) the zipfile will work under</span>
<span class="sd">    :ivar zipfile.Zipfile z: object that holds the zipfile information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">):</span>

        <span class="c1"># the directory of the zip file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fname_zip</span> <span class="o">=</span> <span class="n">fname</span>

        <span class="c1"># the mode (reading, writing) of accessing the zipfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span>   <span class="o">=</span> <span class="n">mode</span>

        <span class="c1"># access the zip file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fname_zip</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>

        <span class="k">return</span>

<div class="viewcode-block" id="CHAD.activity_times"><a class="viewcode-back" href="../chad.html#chad.CHAD.activity_times">[docs]</a>    <span class="k">def</span> <span class="nf">activity_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">act_codes</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function finds the  activity data (given by act_codes) in the dataframe df.</span>

<span class="sd">        :param pandas.core.frame.DataFrame df: events data</span>
<span class="sd">        :param list act_codes: the list of CHAD activity codes specifying 1 general activity</span>
<span class="sd">        :return: the activity data for the selected activity codes </span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># find the indices of activities in act_list</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">act_codes</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">act</span><span class="o">.</span><span class="n">values</span> <span class="p">]</span>

        <span class="c1"># the number of corresponding data entries found</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="c1"># empty data frame</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">N</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>

            <span class="c1"># get the data of the select activities</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

            <span class="c1"># group activity data by CHADID</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CHADID&#39;</span><span class="p">)</span>

            <span class="c1"># merge adjacent time periods</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_time</span><span class="p">(</span> <span class="n">gb</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">temp</span><span class="o">.</span><span class="n">CHADID</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="CHAD.get_data"><a class="viewcode-back" href="../chad.html#chad.CHAD.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the decompressed data from the given file</span>

<span class="sd">        :param str fname: the name of the file to decompressed</span>

<span class="sd">        :return data: the data</span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># store data in data frame</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="CHAD.sum_time"><a class="viewcode-back" href="../chad.html#chad.CHAD.sum_time">[docs]</a>    <span class="k">def</span> <span class="nf">sum_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function merges two similar adjacent activities into one activity. This function is used normally for \</span>
<span class="sd">        the CHAD events data.</span>
<span class="sd">        </span>
<span class="sd">        :param pandas.core.frame.DataFrame df: the dataframe corresponding to a specific CHAD identifier</span>
<span class="sd">        :return: the dataframe where adjacent activities are merged into one activity</span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get the start values except the first entry</span>
        <span class="n">temp_start</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># get the end values except the last entry</span>
        <span class="n">temp_end</span>    <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># find indices where the start times and end times are not equal. This indicates that adjacent events are \</span>
        <span class="c1"># two different events (not contiguous)</span>
        <span class="n">change</span>  <span class="o">=</span> <span class="n">temp_start</span> <span class="o">!=</span> <span class="n">temp_end</span>

        <span class="c1"># store the start time, end time for different/ non-contiguous activities</span>
        <span class="n">start</span>   <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">temp_start</span><span class="p">[</span><span class="n">change</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">end</span>     <span class="o">=</span> <span class="n">temp_end</span><span class="p">[</span><span class="n">change</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="c1"># the duration for the activity</span>
        <span class="n">dt</span>      <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span><span class="p">)</span> <span class="o">%</span> <span class="mi">24</span>

        <span class="c1"># the number of entries for different activities</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

        <span class="c1"># the CHAD identifier</span>
        <span class="n">chadid</span>  <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">CHADID</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">N</span>

        <span class="c1"># the person identifier</span>
        <span class="n">pid</span>     <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">PID</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">N</span>

        <span class="c1"># the activity code</span>
        <span class="n">act</span>     <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">act</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">N</span>

        <span class="c1"># the date</span>
        <span class="n">date</span>    <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">N</span>

        <span class="c1"># store the data for the data frame in a a dictionary</span>
        <span class="n">d</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CHADID&#39;</span><span class="p">:</span> <span class="n">chadid</span><span class="p">,</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span> <span class="n">pid</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">end</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span> <span class="s1">&#39;act&#39;</span><span class="p">:</span> <span class="n">act</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">}</span>

        <span class="c1"># store the data in a data frame with the appropriate column order</span>
        <span class="n">result</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)[</span><span class="n">EVENTS_COLNAMES</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="CHAD.toString"><a class="viewcode-back" href="../chad.html#chad.CHAD.toString">[docs]</a>    <span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represent the contents of the compressed file.</span>

<span class="sd">        :return: a string representation of the CHAD object</span>
<span class="sd">        :rtype: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="s1">&#39;zipfile name:</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fname_zip</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="s1">&#39;contents of zip file</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span> <span class="p">)</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">msg</span></div></div>

<span class="c1"># ===============================================</span>
<span class="c1"># class CHAD_RAW</span>
<span class="c1"># ===============================================</span>

<div class="viewcode-block" id="CHAD_RAW"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW">[docs]</a><span class="k">class</span> <span class="nc">CHAD_RAW</span><span class="p">(</span><span class="n">CHAD</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a specific instance of :class:`chad.CHAD` that is made for accessing the raw \</span>
<span class="sd">    CHAD data for accessing the questionnaire database and the events database.</span>

<span class="sd">    :param int min_age: the minimum age [years] for the CHAD data age range</span>
<span class="sd">    :param int max_age: the maximum age [years] for the CHAD data age range</span>
<span class="sd">    </span>
<span class="sd">    :ivar pandas.core.frame.DataFrame quest: the CHAD questionnaire data </span>
<span class="sd">    :ivar pandas.core.frame.DataFrame events: the CHAD events data    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_age</span><span class="o">=</span><span class="n">social</span><span class="o">.</span><span class="n">ADULT_AGE</span><span class="p">,</span> <span class="n">max_age</span><span class="o">=</span><span class="n">social</span><span class="o">.</span><span class="n">MAX_AGE</span><span class="p">):</span>

        <span class="c1"># call the parent class constructor</span>
        <span class="n">CHAD</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">FNAME_CHAD</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="c1"># load the CHAD questionnaire data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quest</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_quest</span><span class="p">()</span>

        <span class="c1"># load the CHAD events data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_events</span><span class="p">()</span>

        <span class="c1"># filter by age</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data_by_age</span><span class="p">(</span><span class="n">min_age</span><span class="p">,</span> <span class="n">max_age</span><span class="p">)</span>

        <span class="c1"># clean the events data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_data</span><span class="p">()</span>

        <span class="k">return</span>

<div class="viewcode-block" id="CHAD_RAW.clean_data"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.clean_data">[docs]</a>    <span class="k">def</span> <span class="nf">clean_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function cleans the data from the loaded CHAD .csv files for the format used for the ABM.</span>
<span class="sd">        </span>
<span class="sd">        #. clean events</span>
<span class="sd">        #. clean dates</span>
<span class="sd">        #. set dates</span>
<span class="sd">        </span>
<span class="sd">        :return: None </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># clean the events data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_events</span><span class="p">()</span>

        <span class="c1"># only keep data with proper dates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_dates</span><span class="p">()</span>

        <span class="c1"># convert the dates strings into datetime objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_dates</span><span class="p">()</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CHAD_RAW.clean_dates"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.clean_dates">[docs]</a>    <span class="k">def</span> <span class="nf">clean_dates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is needed in order to remove data where there are no dates from the dataframes that \</span>
<span class="sd">        represent the CHAD questionnaire data and the CHAD events data.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># find indices where the date is a string (ie, not NaN)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span> <span class="p">)</span>

        <span class="c1"># the indices of dates for the questionnaire and events</span>
        <span class="n">idx_q</span>   <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">idx_e</span>   <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># update the CHAD questionnaire data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quest</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="p">[</span><span class="n">idx_q</span><span class="p">]</span>

        <span class="c1"># update the CHAD events data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="n">idx_e</span><span class="p">]</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CHAD_RAW.clean_events"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.clean_events">[docs]</a>    <span class="k">def</span> <span class="nf">clean_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This cleans the time information in the CHAD events data.</span>
<span class="sd">        </span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># handle the time information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_times</span><span class="p">()</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CHAD_RAW.convert_activity_code"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.convert_activity_code">[docs]</a>    <span class="k">def</span> <span class="nf">convert_activity_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function converts the activity code from a string into an integer. It also converts &#39;X&#39; \</span>
<span class="sd">        and &#39;U&#39; into a numerical value.</span>

<span class="sd">        :param string x: the activity code that needs to be converted</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ACT_X</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ACT_U</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">y</span></div>

<div class="viewcode-block" id="CHAD_RAW.convert_military_to_decimal_time"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.convert_military_to_decimal_time">[docs]</a>    <span class="k">def</span> <span class="nf">convert_military_to_decimal_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function converts military time [00 00 - 23 59] to decimal time [0.0 - 24).</span>
<span class="sd">        </span>
<span class="sd">        :param int x: an integer representation of the military time where 09:00 is represented by 0900.</span>
<span class="sd">        </span>
<span class="sd">        :return: the time converted into decimal time</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the 1 hour in terms of minutes</span>
        <span class="n">HOUR_2_MIN</span>  <span class="o">=</span> <span class="n">temporal</span><span class="o">.</span><span class="n">HOUR_2_MIN</span>

        <span class="c1"># amount of hours</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">x</span> <span class="o">//</span> <span class="mi">100</span>

        <span class="c1"># amount of minutes in terms of fractional hours</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">100</span> <span class="p">)</span> <span class="o">/</span> <span class="n">HOUR_2_MIN</span>

        <span class="c1"># the decimal time</span>
        <span class="n">decimal_time</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">m</span>

        <span class="k">return</span> <span class="n">decimal_time</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_data_by_age"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_data_by_age">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_by_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_age</span><span class="p">,</span> <span class="n">max_age</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function samples the CHAD data by age via the age range inputs.</span>
<span class="sd">        </span>
<span class="sd">        :param int min_age: the minimum age [years]</span>
<span class="sd">        :param int max_age: the maximum age [years]</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the age</span>
        <span class="n">age</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># the indices</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="n">min_age</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span> <span class="o">&lt;=</span> <span class="n">max_age</span><span class="p">)</span>

        <span class="c1"># the unique PIDs of people above a certain age</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="o">.</span><span class="n">PID</span><span class="p">[</span> <span class="n">idx</span> <span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># group the events by PID</span>
        <span class="n">gb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;PID&#39;</span><span class="p">)</span>

        <span class="c1"># collect the data frames for the events</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">gb</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pid</span><span class="p">]</span>

        <span class="c1"># set the events and questionnaire data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quest</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_events"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_events">[docs]</a>    <span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function gets the raw CHAD events data and returns it in the appropriate column order.</span>
<span class="sd">        </span>
<span class="sd">        :return: the CHAD events data </span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_events_raw</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">EVENTS_RAW_COLNAMES</span><span class="p">]</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_events_raw"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_events_raw">[docs]</a>    <span class="k">def</span> <span class="nf">get_events_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns a data frame of the raw events data.</span>
<span class="sd">        </span>
<span class="sd">        :return data: the raw CHAD events data</span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the raw CHAD events data</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">FNAME_EVENTS</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>

        <span class="c1"># recall that the activity codes contain numeric and non-numeric data</span>
        <span class="n">df</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">act</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_activity_code</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># get the PID</span>
        <span class="n">df</span><span class="o">.</span><span class="n">PID</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CHADID</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_PID</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_PID"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_PID">[docs]</a>    <span class="k">def</span> <span class="nf">get_PID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a CHADID, this function returns the PID. The PID is the CHADID stripped of the last character, \</span>
<span class="sd">        which is a code for the day record.</span>
<span class="sd">        </span>
<span class="sd">        :param string x: the CHADID</span>
<span class="sd">        :return: the PID</span>
<span class="sd">        :rtype: numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pid</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;EPA&#39;</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pid</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_quest"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_quest">[docs]</a>    <span class="k">def</span> <span class="nf">get_quest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns a data frame of the raw questionnaire data. However, the data must have the date \</span>
<span class="sd">        marked explicitly to be accepted.</span>
<span class="sd">        </span>
<span class="sd">        :return: the CHAD questionnaire data in the correct column order</span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get the raw questionnaire data</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_quest_raw</span><span class="p">()</span>

        <span class="c1"># which indices have the date marked</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="p">)</span>

        <span class="c1"># only keep questionnaire data with non NaN entries for dates</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">QUEST_COLNAMES</span><span class="p">]</span></div>

<div class="viewcode-block" id="CHAD_RAW.get_quest_raw"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.get_quest_raw">[docs]</a>    <span class="k">def</span> <span class="nf">get_quest_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns a data frame of the raw questionnaire data and add the PID information.</span>

<span class="sd">        :return: the raw CHAD questionnaire data</span>
<span class="sd">        :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">FNAME_QUEST</span><span class="p">)</span>

        <span class="c1"># get the PID</span>
        <span class="n">df</span><span class="o">.</span><span class="n">PID</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CHADID</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_PID</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="CHAD_RAW.set_dates"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.set_dates">[docs]</a>    <span class="k">def</span> <span class="nf">set_dates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function converts the date information in the CHAD questionnaire and CHAD events datafrmaes \</span>
<span class="sd">        from strings to python datetime objects.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="o">.</span><span class="n">date</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quest</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">date</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CHAD_RAW.set_times"><a class="viewcode-back" href="../chad.html#chad.CHAD_RAW.set_times">[docs]</a>    <span class="k">def</span> <span class="nf">set_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function handles setting the time information for formatting in the CHAD questionnaire and events \</span>
<span class="sd">        dataframes</span>
<span class="sd">        </span>
<span class="sd">        #. converts the time from military time (0000 - 2359] to decimal time [0, 24) in the CHAD \</span>
<span class="sd">        evnets and questionnaire data for the start time and end time</span>
<span class="sd">        #. converts the duration to hours</span>
<span class="sd">        #. drops the military time (start time and end time) and duration (minutes) from the respective \</span>
<span class="sd">        data frames</span>
<span class="sd">        </span>
<span class="sd">        :return: None </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># converts 1 hour into minutes</span>
        <span class="n">HOUR_2_MIN</span>  <span class="o">=</span> <span class="n">temporal</span><span class="o">.</span><span class="n">HOUR_2_MIN</span>

        <span class="c1"># convert times from minutes to hours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_military_to_decimal_time</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;starttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_military_to_decimal_time</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;endtime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">HOUR_2_MIN</span>

        <span class="c1"># delete columns dealing with the time in minutes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;starttime&#39;</span><span class="p">,</span> <span class="s1">&#39;endtime&#39;</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

        <span class="k">return</span></div></div>

<span class="c1"># ===============================================</span>
<span class="c1"># module functions</span>
<span class="c1"># ===============================================</span>
<div class="viewcode-block" id="sample_stats"><a class="viewcode-back" href="../chad.html#chad.sample_stats">[docs]</a><span class="k">def</span> <span class="nf">sample_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes sample data and returns the mean and the standard deviation.</span>

<span class="sd">    :param pandas.core.frame.DataFrame sample: the data to analyze</span>

<span class="sd">    :return s_mean: the mean of the sample data</span>
<span class="sd">    :return s_std: the standard deviation of the sample data</span>
<span class="sd">    :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">    :rtype: pandas.core.frame.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get the mean, standard deviation from a sample from CHAD</span>
    <span class="c1"># statistics</span>
    <span class="n">s_mean</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
    <span class="n">s_std</span>  <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="p">(</span><span class="n">s_mean</span><span class="p">,</span> <span class="n">s_std</span><span class="p">)</span></div>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Namdi Brandon.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>